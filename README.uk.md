# дощова бочка

> Цей проект про розумний резервуар для води. Він вимірює рівень води та надсилає дані на сервер. Сервер можна використовувати для управління водяним насосом. Керувати насосом можна через веб-інтерфейс або через телеграм-бот. Для вимірювання рівня води використовується ультразвуковий датчик HC-SR04. Дані надсилаються до TTN через шлюз LoRaWAN.

?> Оригінальний документ було написано в[англійська](README.md). Переклад виконано за допомогою Google Translate. Якщо ви знайшли якісь помилки, спробуйте їх проігнорувати. Дякую тобі!

* * *

## Зміст

1.  **Швидкий початок**
    1.  вступ
    2.  Обладнання
    3.  Програмне забезпечення Flash
2.  **Обладнання**
    1.  Датчики
    2.  Блок живлення
    3.  житло
    4.  мікроконтролер
    5.  антена
3.  **Збірка**
    1.  Від датчика до контролера
    2.  Живлення до контролера
    3.  Вирішення проблем
4.  **Налаштування**
    1.  ТТН
        1.  Створити акаунт
        2.  Створити додаток
        3.  Налаштувати декодер
        4.  Копіювати облікові дані
    2.  пристрій
        1.  Завантажити драйвер
        2.  Блимає
        3.  Конфігурація
5.  **Налагодження**
    1.  Послідовний монітор
    2.  Консоль ТТН
    3.  Клієнт MQTT
    4.  Підводні камені
6.  **Інженерія даних**
    1.  Вузол RED
    2.  Графана
    3.  Alexa Skill
    4.  Azure Connect

* * *

## Швидкий початок

### Швидкий початок - Вступ

Швидкий старт створений для людей, які хочуть почати відразу та отримати глибокі знання про IoT із Arudino Framework. Якщо ви хочете зрозуміти, як це працює, ви можете прочитати[документація](#hardware).

### Швидкий старт - Огляд обладнання

Вам потрібні наступні частини:

![Overview](_media/hardware/hardware-overview.png)

-   Мікроконтролер з мікросхемою LoRa
-   датчик
-   Блок живлення
-   житло

?> Якщо ви хочете дізнатися більше про частини, ви можете прочитати[апаратна документація](#Hardware).

### Швидкий старт - програмне забезпечення Flash

1.  Підключіть дошку до комп’ютера та
2.  Натисніть на наступну кнопку:

<esp-web-install-button manifest="/static/firmware_build/manifest.json"></esp-web-install-button>

?> Якщо ви хочете дізнатися більше про процес перепрошивки, ви можете прочитати[документація з налаштування](#Setup).

## Обладнання

1.  [Датчики](#Sensors)
2.  [Блок живлення](#Power-supply)
3.  [житло](#Housing)
4.  [мікроконтролер](#Microcontroller)
5.  [антена](#Antenna)

### Датчики

Для вимірювання рівня води потрібен датчик. Це непросте завдання знайти водонепроникний датчик, який можна використовувати в резервуарі для води. Підтримуються та рекомендуються такі датчики:

| частина                                                              | опис                                                                                                                                                                                                                                                                                                                                                                                                   |
| -------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| <img src="_media/hardware/sensor-hcsr04.svg" alt="HC-S$04 sensor" /> | [Ультразвуковий датчик HC-SR04](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)Датчик порівняно дешевий і простий у використанні. Він не є водонепроникним. Ви повинні помістити його у водонепроникний корпус. Ми рекомендуємо цей датчик, якщо ви просто хочете його випробувати. Не рекомендується для тривалого використання.                        |
| <img src="_media/hardware/sensor-hcsr04.svg">                        | [Лазерний датчик](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)Датчик порівняно дешевий і простий у використанні. Як і HC-SRo4, він не є водонепроникним, але має вищу точність. Ви повинні помістити його у водонепроникний корпус. Ми рекомендуємо цей датчик, якщо ви просто хочете його випробувати. Не рекомендується для тривалого використання. |

#### Початківець

-   [Ультразвуковий датчик HC-SR04](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)
-   [Лазерний датчик](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)

#### Просунутий

-   [Датчик води](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)
-   [Водонепроникний ультразвуковий датчик](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)

### Блок живлення

Для живлення мікроконтролера потрібен блок живлення. Акумулятор 18650 - оптимальний варіант. Це дешево, і ви можете заряджати його за допомогою сонячної панелі. Але ви також можете використовувати павербанк або USB-блок живлення.

| частина                                               | опис                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ----------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <img src="_media/hardware/hardware-18650.svg" />      | Існує багато типів акумуляторів. Найбільш поширеними є літій-іонний, літій-полімерний і літій-залізофосфатний. The**Батарея 18650**це літій-іонний акумулятор. Це найкращий варіант для цього проекту. Це дешево, і ви можете заряджати його за допомогою сонячної панелі. Він виготовлений з літій-іонів і може заряджатися до 500 разів. Акумулятор 18650 має напругу 3,7 В і може мати ємність близько 2200 мАг. Сонячна панель має напругу 5 В і потужність 2 Вт. Сонячна панель здатна зарядити акумулятор за 3 години. Наш датчик потребує 5 В і 100 мА. Для мікроконтролера потрібно 5 В і 100 мА. Отже, нам потрібні дві батареї 18650 і регулятор напруги, щоб отримати 5 В. Акумулятор не є водонепроникним. Ви повинні помістити його у водонепроникний корпус. Також подбайте про високі температури. Акумулятор може вибухнути, якщо він занадто гарячий. Ми рекомендуємо цей акумулятор, якщо ви хочете використовувати його протягом тривалого часу. |
| <img src="_media/hardware/hardware-solarpanel.png" /> | **Сонячна панель:**Оскільки посуд є в нашому саду, ми можемо використовувати сонячну панель. Він водонепроникний і може використовуватися під дощем. Він виготовлений з полікристалічного кремнію і має потужність 2 Вт. Якщо ви купуєте сонячну панель, ви повинні переконатися, що вона має вихідну напругу 5 В принаймні 400 мА. Щоб заряджати наші акумулятори, нам потрібен контролер заряду. На щастя, мікроконтролер має вбудований контролер заряду. Тому ми можемо використовувати сонячну панель безпосередньо.                                                                                                                                                                                                                                                                                                                                                                                                                                           |

### житло

Щоб захистити датчик і мікроконтролер, потрібен корпус. Корпус повинен бути водонепроникним і трохи стійким до високих температур і ультрафіолетового випромінювання.
Використовуйте PLA лише для прототипів. Він не є водонепроникним і може бути зруйнований УФ-випромінюванням. Використовуйте ABS для тривалого використання. Він водонепроникний і стійкий до ультрафіолету. Ви також можете використовувати PETG. Він водонепроникний і стійкий до ультрафіолету. Але він не такий міцний, як ABS.

Навіть Tupperware є хорошим варіантом. Він водонепроникний і стійкий до ультрафіолету.

### мікроконтролер

Мікроконтролер - це мозок системи. Він відповідає за вимірювання рівня води та відправку даних на сервер. Підтримуються та рекомендуються такі мікроконтролери:

| частина                                            | опис                                                                                                                                                                                                                                                                                                                   |
| -------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <img src="_media/hardware/hardware-esplora.svg" /> | **схильні протегувати:**TTGO LoRa32 — це мікроконтролер із модулем LoRa. Він дешевий і простий у використанні. Він не є водонепроникним. Ви повинні помістити його у водонепроникний корпус. Ми рекомендуємо цей мікроконтролер, якщо ви просто хочете його випробувати. Не рекомендується для тривалого використання. |

* * *

| частина                                                           | опис                                                                                                                          |
| ----------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| <img src="_media/hardware/sensor-hcsr04.svg" width="244" />       | [Ультразвуковий датчик HC-SR04](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1) |
| <img src="_media/hardware/hardware-esplora.svg" width="244" />    | [Заголовок на випас](https://www.amazon.de/gp/product/B07B4J8QZK/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&psc=1)            |
| <img src="_media/hardware/hardware-18650.svg" width="144" />      | Батарея 18650                                                                                                                 |
| <img src="_media/hardware/hardware-solarpanel.svg" width="244" /> | Сонячна панель                                                                                                                |

Наступні частини є рекомендаціями. Ви можете використовувати інші частини, якщо хочете. Але, можливо, вам доведеться змінити код. Рекомендуються такі частини:

#### LoRaWAN

-   Шлюз LoRaWAN

#### Мікро контролер

Очевидно, що вам потрібна плата для запуску програмного забезпечення. Але вам також потрібен чіп LoRa, щоб надсилати дані на TTN. Підтримуються такі дошки:

-   [Заголовок на випас](Hardware/TTGOLoRa32.md)
-   [Heltec LoRa32](Hardware/HeltecLoRa32.md)

### Схематичний

![Schematic](https://raw.githubusercontent.com/Regenfass/Regenfass/master/Hardware/Schematic.png)

### 3D-друковані частини

## програмне забезпечення

### Arduino

-   [Arduino](Software/Arduino/README.md)

### Сервер

-   [Сервер](Software/Server/README.md)

### Telegram бот

-   [Telegram бот](Software/TelegramBot/README.md)

## Ліцензія

[Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0/)

**Ви можете:**

-   Поділіться — копіюйте та розповсюджуйте матеріал у будь-якому носії чи форматі
-   Адаптуйте — створюйте ремікси, трансформуйте та надбудовуйте матеріал

* * *

_Зроблено за допомогою ❤️[документувати](https://docsify.js.org/)_
